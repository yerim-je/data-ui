<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
    
    <style>
        #wrap{width:500px; margin:0 auto;}
        #content{width:100%; border-collapse:collapse;}
        #content th{border:1px solid black}
        #content td{border:1px solid #aaa}
    </style>
</head>
<body>
    <div id="wrap">
        <div id="input_box">
            <input type="text" name="search" id="search">
            <button id="bt">검색</button>
        </div>
        <div id="result_box">
            <table id="content">
                <thead>
                    <th>이름</th> <th> 현재 상태</th>
                </thead>
                <tbody id="state_detail">

                </tbody>
            </table>
        </div>
    </div>
</body>
</html>

<script>
    // getJSON은 json파일을 열어서 파일안의 내용을 가져오기 위한 함수이다.
    // getJSON("파일의 경로 또는 url", 가져와서 실행할 함수)

    
    // json파일을 자바스크립트의 객체로 가져왔기 때문에 이후의 코드는 
    // 자바스크립트의 제어문, 함수등을 활용한다.
    // input에 입력하여 검색하기 만들기
    // 1. json 파일 불러오기
    // 2. 가져온 객체 화면에 띄우기
    //   - 화면에 표시하려면 json데이터가 어떤내용을 가지고 있는지 확인하고 
    //   그에 맞는 html을 구상해야한다.
    //   - 지금 json내용은 key부분이 이름이고, value부분이 감정이니깐 
    //   화면에 표시 될 내용은 두가지뿐이다.
    //   table을 활용할 것인지 div를 활용할 것인지 ol,ul,dl을 활용할 것인지
    //   선택해야 한다. 어떤것을 사용할지는 제작자 본인이 알아서 판단
    //   많이 만들어봐야 지금 데이터에는 어떤 태그 사용이 좋을지 알수 있다.
    
    // 3. 검색기능 만들기
    //  검색은 어느범위까지 적용할 것인지 정해야 한다.
    //  모든 내용에 적용할 것인지 아니면 특정 부분에만 적용할 것인지
    //  지금 JSON 내용에서 이름만 검색하게 만들것이냐
    //  감정 내용만 검색하게 만들 것이냐, 아니면 둘 다 가능하게 할 것이냐
    
    
    $.getJSON("./data/test.json",function(d){
        console.log(d);
        console.log(d.송은선);
        var key_arr = Object.keys(d);
        console.log(key_arr);   // Array는 배열

        // for(var i=0; i<key_arr.length; i++){
        //     $("#state_detail").append("<tr><td>"+key_arr[i]+"</td><td>"+d[key_arr[i]] +"</td></tr>")
        // }
    $.each(key_arr,function(인덱스, 데이터){
       $("#state_detail").append("<tr class='data_row'><td class='name'>"+데이터+"</td><td class='state'>"+d[데이터]+"</td></tr>") 
    })

        // $("#state_detail").append("<tr><td>"+key[0]+"</td> <td>"+d[key[0]]+"</td></tr>")
        // $("#state_detail").append("<tr><td>"+key[1]+"</td><td>"+d[key[1]] +"</td></tr>")
        // $("#state_detail").append("<tr><td>"+key[2]+"</td><td>"+d[key[2]] +"</td></tr>")
        // $("#state_detail").append("<tr><td>"+key[3]+"</td><td>"+d[key[3]] +"</td></tr>")
    });

    $("#bt").click(function(){  // 검색기능 만들기
        var word = $("#search").val();   //input 입력값 가져오기
    //input 태그에 입력한 text가 포함되어 있는 또는 일치하는 text를 tbody에서 찾아야 한다.
    // 찾아서 해당 tr만 화면에 표시, 나머지는 감추기를 해야한다.
        $("#state_detail>tr").filter(function(idx){
            
            return $(this).text().indexOf(word) == -1;
            // console.log(idx) // tr태그의 index
            // return idx==0 || idx == 3;
        }).toggle();
        // #state)_detail > id가 state_detail인 태그
        // #state)_detail>tr > id가 state_detail인 태그의 하위태그중 tr태그
        // :nth-child(even) > 하위태그 중 짝수태그

    });
</script>
<!-- 
    json은 자바스크립트 객체를 문서로 저장한 파일형식이다.
    문서(파일)에 저장되려면 일반젇으로 문자열 형식이어야 한다. 
    자바스크립트의 객체는 key와 value로 이루어져 있다.
    { 신상수 : "기분이 좋다.", 송은선 : "기분이 별로다." }
    신상수와 송은선이 key에 해당하고
    "기분이 좋다."와 "기분이 별로다."는 value에 해당한다.

    객체의 key는 데이터로서의 활용 보다는 참조의 역할이 강하다.
    데이터로서의 역할은 value를 사용한다.
    key를 이용해서 value를 사용한다.

    사물함에 서로 다른 자물쇠가 있다면 특정 사물함을 열기 위해서는 그 사물함에 채워져 있는 
    자물쇠에 맞는 키가 필요하다.
    올바른, 알맞는 키를 사용해야 안에 내용물을 볼 수 있다. 

    자바스크립트의 객체에서 key를 통해 value를 얻고자한다면 
    객체명.key를 작성해야 해당 key에 맞는 value를 얻을 수 있다. 
    
    let 신상수 = { 어제:"우울", 오늘:"좋음",내일:"행복" }
    console.log(신상수.어제)
    콘솔의 결과는 우울이다. 

    자바스크립트의 객체를 
    { 어제:"우울", 오늘:"좋음" ,내일:"행복"}

    json파일로 저장하기 위해서는 모두 문자열로 변환한다.
    { "어제" : "우울","오늘":"좋음","내일":"행복"}

    객체의 key와 value 모두 문자열로 변환된다. 단, 숫자는 그냥 숫자로 
    
-->